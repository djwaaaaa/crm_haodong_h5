(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0aee1c40","chunk-2d2218e1","chunk-2d21a075"],{"1f34":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[s("template",{slot:"header"},[e._v("用户管理")]),s("d2-crud-x",e._g(e._b({ref:"d2Crud",on:{authz:e.authzHandle,setPassword:e.setPasswordFun}},"d2-crud-x",e._crudProps,!1),e._crudListeners),[s("div",{attrs:{slot:"header"},slot:"header"},[s("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),s("el-button-group",[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"system.admin/add",expression:"'system.admin/add'"}],attrs:{size:"small",type:"primary"},on:{click:e.addRow}},[s("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1),s("crud-toolbar",{attrs:{search:e.crud.searchOptions.show,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:search":function(t){return e.$set(e.crud.searchOptions,"show",t)},"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}})],1)]),s("el-dialog",{attrs:{title:"授予角色",visible:e.dialogPermissionVisible},on:{"update:visible":function(t){e.dialogPermissionVisible=t}}},[s("el-checkbox-group",{model:{value:e.checkedRoleIds,callback:function(t){e.checkedRoleIds=t},expression:"checkedRoleIds"}},e._l(e.roleList,(function(t){return s("el-checkbox",{key:t.id,staticClass:"d2-mb-10",attrs:{label:t.id}},[e._v(e._s(t.title)+" ")])})),1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatePermession(e.currentUserId)}}},[e._v("确定 ")])],1)],1),s("el-dialog",{attrs:{title:"设置密码",visible:e.dialogPasswordVisible},on:{"update:visible":function(t){e.dialogPasswordVisible=t}}},[s("div",{staticClass:"passwordForm"},[s("div",{staticClass:"formItem"},[s("p",[e._v("用户名称：")]),s("el-input",{attrs:{disabled:!0},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),s("div",{staticClass:"formItem"},[s("p",{staticClass:"name"},[e._v("登录密码：")]),s("el-input",{class:{passwordError:e.passwordError},attrs:{placeholder:"请输入登录密码","show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("div",{staticClass:"formItem"},[s("p",{staticClass:"name"},[e._v("确认密码：")]),s("el-input",{class:{confirmPasswordError:e.confirmPasswordError},attrs:{placeholder:"请输入确认密码","show-password":""},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}})],1)]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatePassword(e.userId)}}},[e._v("确定 ")])],1)])],2)},o=[],a=(s("4de4"),s("c975"),s("d81d"),s("22ce")),i=s("cb9e"),n=s("ba88"),d=s("1fbf"),c={name:"formSelect",mixins:[d["d2CrudPlus"].crud],data:function(){return{roleList:[],checkedRoleIds:[],dialogPermissionVisible:!1,currentUserId:void 0,dialogPasswordVisible:!1,userId:null,userName:null,password:"",confirmPassword:"",passwordError:!1,confirmPasswordError:!1}},methods:{getCrudOptions:function(){return Object(n["crudOptions"])(this)},pageRequest:function(e){return i["GetList"](e)},addRequest:function(e){return console.log("api",i),i["AddObj"](e)},updateRequest:function(e){return console.log("----",e),i["UpdateObj"](e)},delRequest:function(e){return i["DelObj"](e.id)},authzHandle:function(e){var t=this;return Object(a["b"])({url:"system.auth/index?page=1&limit=",method:"get"}).then((function(s){console.log(s,"角色",e);var r=s.data,o=e.row.auth_ids;console.log(o,"用户信息"),o||(o=[]);var a=r.map((function(e){return e.id})).filter((function(e){return o.indexOf(e)>=0}));t.$set(t,"checkedRoleIds",a),t.$set(t,"roleList",r),t.currentUserId=e.row.id,t.dialogPermissionVisible=!0}))},updatePermession:function(e){var t=this;i["DoAuthz"](e,this.checkedRoleIds).then((function(e){t.dialogPermissionVisible=!1,t.doRefresh()}))},setPasswordFun:function(e){console.log(123,e);this.userName=e.row.username,this.userId=e.row.id,this.dialogPasswordVisible=!0},updatePassword:function(e){var t=this;return""==this.password?(this.passwordError=!0,!1):""==this.confirmPassword||this.password!=this.confirmPassword?(this.confirmPasswordError=!0,!1):Object(a["b"])({url:"system.admin/password?id="+e,method:"post",data:{username:this.userName,password:this.password,password_again:this.confirmPassword}}).then((function(e){t.dialogPasswordVisible=!1,t.$message({message:"设置成功",type:"success"})}))}}},l=c,u=(s("9898"),s("2877")),m=Object(u["a"])(l,r,o,!1,null,null,null);t["default"]=m.exports},5026:function(e,t,s){},9898:function(e,t,s){"use strict";var r=s("5026"),o=s.n(r);o.a},ba88:function(e,t,s){"use strict";s.r(t),s.d(t,"crudOptions",(function(){return o}));var r=s("ade3"),o=function(e){var t;return{rowHandle:{fixed:"right",width:360,edit:{thin:!0,disabled:function(){return!e.hasPermissions("system.admin/edit")}},remove:{thin:!0,disabled:function(){return!e.hasPermissions("system.admin/delete")}},custom:[{thin:!0,text:"设置密码",type:"success",size:"small",emit:"setPassword",icon:"el-icon-setting",disabled:function(){return!e.hasPermissions("system.admin/password")}},{thin:!0,text:"授权",type:"warning",size:"small",emit:"authz",icon:"el-icon-s-flag",disabled:function(){return!e.hasPermissions("system.admin/edit")}}],view:{show:!1}},pageOptions:{compact:!1},options:{height:"100%"},viewOptions:{componentType:"row"},formOptions:{defaultSpan:12},columns:[{title:"ID",key:"id",width:60,sortable:!0,form:{disabled:!0}},Object(r["a"])({title:"排序",key:"sort",sortable:!0,type:"text",width:60},"sortable",!0),{title:"用户名",key:"username",type:"text"},{title:"真实姓名",key:"realname",type:"text"},{title:"头像",key:"head_img",type:"avatar-uploader"},{title:"手机",key:"phone",type:"text"},{title:"登陆次数",key:"login_num",type:"text",form:{disabled:!0}},{title:"备注",key:"remark",type:"text"},(t={title:"状态",key:"status",type:"text"},Object(r["a"])(t,"type","dict-switch"),Object(r["a"])(t,"dict",{data:[{value:1,label:"开启"},{value:0,label:"关闭"}]}),Object(r["a"])(t,"form",{component:{value:1,show:function(e){return!0}}}),t),{title:"创建日期",key:"create_time",type:"text",width:150,form:{disabled:!0}}]}}},cb9e:function(e,t,s){"use strict";s.r(t),s.d(t,"GetList",(function(){return o})),s.d(t,"AddObj",(function(){return a})),s.d(t,"UpdateObj",(function(){return i})),s.d(t,"DelObj",(function(){return n})),s.d(t,"GetCascadeData",(function(){return d}));var r=s("22ce");function o(e){return Object(r["b"])({url:"system.admin/index",method:"post",data:{page:e.current,limit:e.size}}).then((function(t){console.log(t,9999,t.data),t.data=t.data?t.data:{},t.data.current=e.current,t.data.size=e.size,t.data.total=t.count;var s=t.data;for(var r in s)delete s[r].update_time,delete s[r].delete_time;return t.data.records=s,t}))}function a(e){return Object(r["b"])({url:"system.admin/add",method:"post",data:e})}function i(e){for(var t in console.log(e,999999),e)console.log(e,777777),delete e.create_time,delete e.login_num,delete e.sort,delete e.status;return console.log(e,9999992222),Object(r["b"])({url:"system.admin/edit",method:"post",data:e})}function n(e){return Object(r["b"])({url:"system.admin/delete",method:"post",data:{id:e}})}function d(){return Object(r["b"])({url:"/select/cascadeData",method:"get"})}}}]);