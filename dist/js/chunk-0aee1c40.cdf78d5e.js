(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0aee1c40","chunk-2d2218e1","chunk-2d21a075"],{"1f34":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("d2-container",{class:{"page-compact":t.crud.pageOptions.compact}},[s("template",{slot:"header"},[t._v("用户管理")]),s("d2-crud-x",t._g(t._b({ref:"d2Crud",on:{authz:t.authzHandle,setPassword:t.setPasswordFun}},"d2-crud-x",t._crudProps,!1),t._crudListeners),[s("div",{attrs:{slot:"header"},slot:"header"},[s("crud-search",{ref:"search",attrs:{options:t.crud.searchOptions},on:{submit:t.handleSearch}}),s("el-button-group",[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addRow}},[s("i",{staticClass:"el-icon-plus"}),t._v(" 新增")])],1),s("crud-toolbar",{attrs:{search:t.crud.searchOptions.show,compact:t.crud.pageOptions.compact,columns:t.crud.columns},on:{"update:search":function(e){return t.$set(t.crud.searchOptions,"show",e)},"update:compact":function(e){return t.$set(t.crud.pageOptions,"compact",e)},refresh:function(e){return t.doRefresh()},"columns-filter-changed":t.handleColumnsFilterChanged}})],1)]),s("el-dialog",{attrs:{title:"授予角色",visible:t.dialogPermissionVisible},on:{"update:visible":function(e){t.dialogPermissionVisible=e}}},[s("el-checkbox-group",{model:{value:t.checkedRoleIds,callback:function(e){t.checkedRoleIds=e},expression:"checkedRoleIds"}},t._l(t.roleList,(function(e){return s("el-checkbox",{key:e.id,staticClass:"d2-mb-10",attrs:{label:e.id}},[t._v(t._s(e.title)+" ")])})),1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updatePermession(t.currentUserId)}}},[t._v("确定 ")])],1)],1),s("el-dialog",{attrs:{title:"设置密码",visible:t.dialogPasswordVisible},on:{"update:visible":function(e){t.dialogPasswordVisible=e}}},[s("div",{staticClass:"passwordForm"},[s("div",{staticClass:"formItem"},[s("p",[t._v("用户名称：")]),s("el-input",{attrs:{disabled:!0},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),s("div",{staticClass:"formItem"},[s("p",{staticClass:"name"},[t._v("登录密码：")]),s("el-input",{class:{passwordError:t.passwordError},attrs:{placeholder:"请输入登录密码","show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),s("div",{staticClass:"formItem"},[s("p",{staticClass:"name"},[t._v("确认密码：")]),s("el-input",{class:{confirmPasswordError:t.confirmPasswordError},attrs:{placeholder:"请输入确认密码","show-password":""},model:{value:t.confirmPassword,callback:function(e){t.confirmPassword=e},expression:"confirmPassword"}})],1)]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updatePassword(t.userId)}}},[t._v("确定 ")])],1)])],2)},o=[],a=(s("4de4"),s("c975"),s("d81d"),s("22ce")),i=s("cb9e"),n=s("ba88"),d=s("1fbf"),c={name:"formSelect",mixins:[d["d2CrudPlus"].crud],data:function(){return{roleList:[],checkedRoleIds:[],dialogPermissionVisible:!1,currentUserId:void 0,dialogPasswordVisible:!1,userId:null,userName:null,password:"",confirmPassword:"",passwordError:!1,confirmPasswordError:!1}},methods:{getCrudOptions:function(){return Object(n["crudOptions"])(this)},pageRequest:function(t){return i["GetList"](t)},addRequest:function(t){return console.log("api",i),i["AddObj"](t)},updateRequest:function(t){return console.log("----",t),i["UpdateObj"](t)},delRequest:function(t){return i["DelObj"](t.id)},authzHandle:function(t){var e=this;return Object(a["b"])({url:"system.auth/index?page=1&limit=",method:"get"}).then((function(s){console.log(s,"角色",t);var r=s.data,o=t.row.auth_ids;console.log(o,"用户信息"),o||(o=[]);var a=r.map((function(t){return t.id})).filter((function(t){return o.indexOf(t)>=0}));e.$set(e,"checkedRoleIds",a),e.$set(e,"roleList",r),e.currentUserId=t.row.id,e.dialogPermissionVisible=!0}))},updatePermession:function(t){var e=this;i["DoAuthz"](t,this.checkedRoleIds).then((function(t){e.dialogPermissionVisible=!1,e.doRefresh()}))},setPasswordFun:function(t){console.log(123,t);this.userName=t.row.username,this.userId=t.row.id,this.dialogPasswordVisible=!0},updatePassword:function(t){var e=this;return""==this.password?(this.passwordError=!0,!1):""==this.confirmPassword||this.password!=this.confirmPassword?(this.confirmPasswordError=!0,!1):Object(a["b"])({url:"system.admin/password?id="+t,method:"post",data:{username:this.userName,password:this.password,password_again:this.confirmPassword}}).then((function(t){e.dialogPasswordVisible=!1,e.$message({message:"设置成功",type:"success"})}))}}},l=c,u=(s("9898"),s("2877")),p=Object(u["a"])(l,r,o,!1,null,null,null);e["default"]=p.exports},5026:function(t,e,s){},9898:function(t,e,s){"use strict";var r=s("5026"),o=s.n(r);o.a},ba88:function(t,e,s){"use strict";s.r(e),s.d(e,"crudOptions",(function(){return o}));var r=s("ade3"),o=function(t){var e;return{rowHandle:{fixed:"right",width:360,custom:[{thin:!0,text:"设置密码",type:"success",size:"small",emit:"setPassword",icon:"el-icon-setting",disabled:function(){}},{thin:!0,text:"授权",type:"warning",size:"small",emit:"authz",icon:"el-icon-s-flag",disabled:function(){}}],view:{show:!1}},pageOptions:{compact:!1},options:{height:"100%"},viewOptions:{componentType:"row"},formOptions:{defaultSpan:12},columns:[{title:"ID",key:"id",width:60,sortable:!0,form:{disabled:!0}},Object(r["a"])({title:"排序",key:"sort",sortable:!0,type:"text",width:60},"sortable",!0),{title:"用户名",key:"username",type:"text"},{title:"真实姓名",key:"realname",type:"text"},{title:"头像",key:"head_img",type:"avatar-uploader"},{title:"手机",key:"phone",type:"text"},{title:"登陆次数",key:"login_num",type:"text",form:{disabled:!0}},{title:"备注",key:"remark",type:"text"},(e={title:"状态",key:"status",type:"text"},Object(r["a"])(e,"type","dict-switch"),Object(r["a"])(e,"dict",{data:[{value:1,label:"开启"},{value:0,label:"关闭"}]}),Object(r["a"])(e,"form",{component:{value:1,show:function(t){return!0}}}),e),{title:"创建日期",key:"create_time",type:"text",width:150,form:{disabled:!0}}]}}},cb9e:function(t,e,s){"use strict";s.r(e),s.d(e,"GetList",(function(){return o})),s.d(e,"AddObj",(function(){return a})),s.d(e,"UpdateObj",(function(){return i})),s.d(e,"DelObj",(function(){return n})),s.d(e,"GetCascadeData",(function(){return d}));var r=s("22ce");function o(t){return Object(r["b"])({url:"system.admin/index",method:"post",data:{page:t.current,limit:t.size}}).then((function(e){return console.log(e,9999,e.data),e.data=e.data?e.data:{},e.data.current=t.current,e.data.size=t.size,e.data.total=e.count,e.data.records=e.data,e}))}function a(t){return Object(r["b"])({url:"system.admin/add",method:"post",data:t})}function i(t){return Object(r["b"])({url:"system.admin/edit",method:"post",data:t})}function n(t){return Object(r["b"])({url:"system.admin/delete",method:"post",data:{id:t}})}function d(){return Object(r["b"])({url:"/select/cascadeData",method:"get"})}}}]);