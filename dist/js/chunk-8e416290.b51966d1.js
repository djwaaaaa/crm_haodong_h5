(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e416290","chunk-2d0f0fc0","chunk-2d2094f5"],{"1ca2":function(e,t,n){},"23d6":function(e,t,n){"use strict";var i=n("1ca2"),o=n.n(i);o.a},"5acc":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[n("el-row",{staticStyle:{height:"100%"},attrs:{gutter:20}},[n("el-col",{staticClass:"leftTable",staticStyle:{height:"100%"},attrs:{span:4}},[n("div",[n("div",{directives:[{name:"permission",rawName:"v-permission",value:"technique/addProduct",expression:"'technique/addProduct'"}],staticClass:"addBox",on:{click:e.addNode}},[n("div",{staticClass:"el-icon-plus"})]),e.treeShow?n("el-tree",{attrs:{data:e.data,"node-key":"id","expand-on-click-node":!0,props:e.treeProps},on:{"node-click":e.click},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,o=t.data;return n("span",{staticClass:"custom-tree-node show-hide"},[1==o.isEdit?[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newApiGroupName,expression:"newApiGroupName"}],ref:"input",staticClass:"nodeInput",staticStyle:{height:"24px line-height:24px"},domProps:{value:e.newApiGroupName},on:{blur:function(){return e.submitEdit(i,o)},input:function(t){t.target.composing||(e.newApiGroupName=t.target.value)}}})]:n("span",{staticClass:"nodeLabel"},[e._v(e._s(i.label))]),n("span",{staticStyle:{display:"none"}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"technique/addProduct",expression:"'technique/addProduct'"}],attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),function(){return e.append(o)}()}}},[n("div",{staticClass:"node-icon el-icon-plus"})]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"technique/editProduct",expression:"'technique/editProduct'"}],attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),function(){return e.edit(i,o)}()}}},[n("div",{staticClass:"node-icon el-icon-edit"})]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"technique/deleteProduct",expression:"'technique/deleteProduct'"}],attrs:{type:"text",size:"mini"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),function(){return e.remove(i,o)}()}}},[n("div",{staticClass:"node-icon el-icon-delete"})])],1)],2)}}],null,!1,267944897)}):e._e()],1)]),n("el-col",{staticClass:"rightTable",staticStyle:{height:"100%"},attrs:{span:18}},[n("template",{slot:"header"},[e._v("产品工艺")]),n("d2-crud-x",e._g(e._b({ref:"d2Crud"},"d2-crud-x",e._crudProps,!1),e._crudListeners),[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"processName"},[e._v(e._s(e.processName))]),n("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),n("el-button-group",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"technique/add",expression:"'technique/add'"}],attrs:{size:"small",type:"primary"},on:{click:e.addRow}},[n("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1),n("crud-toolbar",{attrs:{search:e.crud.searchOptions.show,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:search":function(t){return e.$set(e.crud.searchOptions,"show",t)},"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}})],1)])],2)],1)],1)},o=[],s=(n("c740"),n("a434"),n("9f63")),a=n("a907"),r=n("1fbf"),c=n("22ce"),d={name:"productProcess",mixins:[r["d2CrudPlus"].crud],data:function(){return{treeShow:!1,data:[],nodeId:0,processName:null,newApiGroupName:"",treeProps:{label:"title"}}},methods:{doLoad:function(){},getCrudOptions:function(){return Object(a["crudOptions"])(this)},pageRequest:function(e){return e.nodeId=this.nodeId,s["GetList"](e)},addRequest:function(e){return console.log("api",s),e.pid=this.nodeId,s["AddObj"](e)},updateRequest:function(e){return console.log("----",e),s["UpdateObj"](e)},delRequest:function(e){return s["DelObj"](e.id)},getNodeList:function(){var e=this;return Object(c["b"])({url:"technique/productList",method:"post"}).then((function(t){console.log(t,3e4);for(var n=t.data,i=0;i<n.length;i++)n[i].lable=n[i].title;console.log(n,300001),e.data=n,e.treeShow=!0}))},addNode:function(){this.appendFun({pid:0,title:"未命名"})},appendFun:function(e){var t=this;return Object(c["b"])({url:"technique/addProduct",method:"post",data:e}).then((function(e){t.$message({message:"添加成功",type:"success"}),t.getNodeList()}))},append:function(e){console.log(e,777),this.appendFun({pid:e.id,title:"未命名"})},edit:function(e,t){var n=this;console.log(t,600),this.$set(t,"isEdit",1),this.newApiGroupName=t.title,this.$nextTick((function(){n.$refs.input.focus()}))},remove:function(e,t){var n=this,i=e.parent,o=i.data.children||i.data,s=o.findIndex((function(e){return e.id===t.id}));this.$confirm("是否确认删除此节点?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(c["b"])({url:"technique/deleteProduct",method:"post",data:{id:t.id}}).then((function(e){n.$message({message:"删除成功",type:"success"}),o.splice(s,1)})).catch((function(e){n.$message({message:e.msg,type:"warning"})}))}))},submitEdit:function(e,t){var n=this;if(console.log(e,t,this.newApiGroupName),t.title!=this.newApiGroupName)return n.$set(t,"isEdit",0),n.$set(t,"title",this.newApiGroupName),Object(c["b"])({url:"technique/editProduct",method:"post",data:t}).then((function(e){n.getNodeList(),n.newApiGroupName="",n.$message({message:"编辑成功",type:"success"})})).catch((function(e){n.$message({message:e.msg,type:"warning"})}));console.log("没有修改"),this.newApiGroupName="",this.$set(t,"isEdit",0)},click:function(e,t,n){console.log(e,t,n,"llala"),e.children||(this.nodeId=e.id,this.processName=e.title,this.doRefresh())},handleNodeClick:function(){},appendNode:function(e,t){},removeNode:function(e,t){var n=this;0==e.childNodes.length?this.$confirm("是否确认删除此节点?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return delNatureTreeNode(t.id)})).then((function(e){200===e.code?(n.getTreeselect(),n.msgSuccess("删除成功")):n.$message({message:e.msg,type:"warning"})})).catch((function(){})):this.$message({message:"该节点下存在子节点，不允许直接删除",type:"warning"})},editNode:function(e,t){var n=this;this.resetNodeForm(),getNatureTreeNode(t.id).then((function(t){200===t.code&&(n.nodeForm=t.data,n.nodeTitle="编辑节点",n.parentTreeName=e.parent.title,n.dialogNodeFormVisible=!0)}))}},mounted:function(){this.doRefresh(),this.getNodeList()}},u=d,l=(n("23d6"),n("2877")),p=Object(l["a"])(u,i,o,!1,null,"4ba730a3",null);t["default"]=p.exports},"9f63":function(e,t,n){"use strict";n.r(t),n.d(t,"GetList",(function(){return o})),n.d(t,"AddObj",(function(){return s})),n.d(t,"UpdateObj",(function(){return a})),n.d(t,"DelObj",(function(){return r})),n.d(t,"GetCascadeData",(function(){return c}));var i=n("22ce");function o(e){return Object(i["b"])({url:"technique/index/pid/"+e.nodeId,method:"post",data:{page:e.current,limit:e.size}}).then((function(t){console.log(t,200,t.data),t.data=t.data?t.data:{},t.data.current=e.current,t.data.size=e.size,t.data.total=t.count;var n=t.data;for(var i in n)delete n[i].create_time,delete n[i].update_time,delete n[i].delete_time;return t.data.records=n,console.log(t,300,t.data),t}))}function s(e){return Object(i["b"])({url:"technique/add",method:"post",data:e})}function a(e){return Object(i["b"])({url:"technique/edit",method:"post",data:e})}function r(e){return Object(i["b"])({url:"technique/delete",method:"post",data:{id:e}})}function c(){return Object(i["b"])({url:"/select/cascadeData",method:"get"})}},a907:function(e,t,n){"use strict";n.r(t),n.d(t,"crudOptions",(function(){return i}));n("22ce");var i=function(e){return{rowHandle:{fixed:"right",width:180,view:{show:!1},edit:{thin:!0,disabled:function(){return!e.hasPermissions("technique/edit")}},remove:{thin:!0,disabled:function(){return!e.hasPermissions("technique/delete")}}},searchOptions:{show:!1},pageOptions:{compact:!1},options:{height:"100%"},viewOptions:{componentType:"row"},formOptions:{defaultSpan:12},columns:[{title:"ID",key:"id",type:"text",disabled:!0,form:{disabled:!0,show:!1}},{title:"pid",key:"pid",type:"text",disabled:!0,form:{disabled:!0,show:!1}},{title:"名称",key:"title",type:"text"},{title:"分钟",key:"minutes",type:"text"},{title:"调试/分钟",key:"debug",type:"text"},{title:"单件/分钟",key:"singleton",type:"text"},{title:"状态",key:"status",type:"dict-switch",dict:{data:[{value:1,label:"开启"},{value:0,label:"关闭"}]},form:{component:{show:function(e){return!e.form.number}}},component:{disabled:function(e){return!e.form.number}}}]}}}}]);